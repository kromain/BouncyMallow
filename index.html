
<!DOCTYPE html>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>HTMLTile testbed</title>
<style type="text/css">
body, html {
  width: 100%;
  height: 100%;
  margin: 0px;
  overflow: hidden;
  background: lightsteelblue;
}
#contents {
  display: inline-block;
  vertical-align: top;
  margin-left: 10px;
  color: midnightblue;
}
#controls {
  display: inline-block;
  box-sizing: border-box;
  height: 100%;
  width: 250px;

  background: rgba(0, 0, 0, 0.85);
  padding: 10px;
  border-radius: 5px;
  border: 2px solid white;
  color: white;
}
#controls h2 {
  margin: 0px;
  margin-top: 20px;
  border-bottom: 1px solid white;
}

#controls table {
  width: 100%;
}
#controls input[type="number"] {
  width: 100%;
}
#controls input[type="url"] {
  width: 100%;
}
</style>
<script src="scripts/query-args.js" type="text/javascript"></script>
<script type="text/javascript">

  function init() {
    initParameters();
    initXRayURL();
    registerLinkOnClickEventHandler();
  }

  function initParameters() {
    extractQueryArgs();

    if (queryArgs.usewebgl != undefined)
      document.getElementById('usewebgl').checked = queryArgs.usewebgl;
    if (queryArgs.showcontrols != undefined)
      document.getElementById('showcontrols').checked = queryArgs.showcontrols;
    if (queryArgs.showfps != undefined)
      document.getElementById('showfps').checked = queryArgs.showfps;

    if (queryArgs.tilecount != undefined)
      document.getElementById('tilecount').value = queryArgs.tilecount;
    if (queryArgs.tilewidth != undefined)
      document.getElementById('tilewidth').value = queryArgs.tilewidth;
    if (queryArgs.tileheight != undefined)
      document.getElementById('tileheight').value = queryArgs.tileheight;
    if (queryArgs.animatetiles != undefined)
      document.getElementById('animatetiles').checked = queryArgs.animatetiles;
    if (queryArgs.destroytimeout != undefined)
      document.getElementById('destroytimeout').value = queryArgs.destroytimeout;
  }

  function initXRayURL() {
    document.getElementById('xrayurl').value = queryArgs.xRayURL ? queryArgs.xRayURL : location.origin + "/X-ray/index.html";
    document.getElementById('usexray').checked = queryArgs.xRayURL;
    showHideXRayUrl();
  }

  function showHideXRayUrl() {
    document.getElementById('xrayurl').style.display = (document.getElementById('usexray').checked ? "inline-block" : "none");
  }

  function getParameters() {
    var parameters = new Object();
    parameters['usewebgl'] = document.getElementById('usewebgl').checked;
    parameters['showcontrols'] = document.getElementById('showcontrols').checked;
    parameters['showfps'] = document.getElementById('showfps').checked;
    parameters['tilecount'] = document.getElementById('tilecount').value;
    parameters['tilewidth'] = document.getElementById('tilewidth').value;
    parameters['tileheight'] = document.getElementById('tileheight').value;
    parameters['animatetiles'] = document.getElementById('animatetiles').checked;
    parameters['destroytimeout'] = document.getElementById('destroytimeout').value;

    return parameters;
  }

  function registerLinkOnClickEventHandler() {
    for (var i = 0 ; i < document.links.length; ++i) {
      document.links[i].addEventListener('click', appendQueryParams, true);
    }
  }

  function appendQueryParams(e) {
    var elem = e.target;

    if (document.getElementById('usexray').checked)
      elem.href = document.getElementById('xrayurl').value + "?host=" + elem.host + "&path=" + elem.pathname + "&args=" + buildArgvString(getParameters());
    else
      elem.href += buildQueryString(getParameters());
    return true;
  }
</script>
</head>

<body onload="init()">
  <div id="controls">
    <h2>Test Settings</h2>
    <table>
    <tr>
      <td>Show Controls:</td>
      <td><input id='showcontrols' type="checkbox" /></td>
    </tr>
    <tr>
      <td>Show FPS Counter:</td>
      <td><input id='showfps' type="checkbox" /></td>
    </tr>
    <tr>
      <td>Use WebGL:</td>
      <td><input id='usewebgl' type="checkbox" /></td>
    </tr>
    <tr>
      <td>Use X-ray Profiler:</td>
      <td><input id='usexray' type="checkbox" onclick="showHideXRayUrl()"/></td>
    </tr>
    </table>
    <input id='xrayurl' type="url" />
    <h2>HTMLTile Settings</h2>
    <table>
    <tr>
      <td>Animate Tiles:</td>
      <td><input id='animatetiles' type="checkbox" checked="true" /></td>
    </tr>
    <tr>
      <td>Tile Count:</td>
      <td><input id="tilecount" type="number" min="0" max="3000" step="1" value="4" /></td>
    </tr>
    <tr>
      <td>Tile Width:</td>
      <td><input id="tilewidth" type="number" min="10" max="3000" step="10" value="250" /></td>
    </tr>
    <tr>
      <td>Tile Height:</td>
      <td><input id="tileheight" type="number" min="10" max="3000" step="10" value="250" /></td>
    </tr>
    <tr>
      <td>Tile Destroy Timeout:</td>
      <td><input id="destroytimeout" type="number" min="1" max="100" step="1" value="1000" /></td>
    </tr>
    </table>
  </div>
  <div id="contents">
    <h1>HTMLTile Tests</h1>
    <ul>
      <li><a href="animatedtiles.html">Animated tiles</a></li>
      <li><a href="largevideotest.html">Gallery video playback</a></li>
      <li><a href="locationchangetest.html">Location change handler</a></li>
      <li><a href="evaltest.html">Tile eval()</a></li>
      <li><a href="unresponsivetiletest.html">Unresponsive tiles</a></li>
    </ul>
    <h1>Individual tiles</h1>
    <ul>
      <li>TODO</li>
    </ul>
  </div>
</body>

</html>
