<!DOCTYPE html>
<html>
<head>
<title>Tile location test</title>
<style type="text/css">
    html, body {
        height: 100%;
        width: 100%;
        margin: 0px;
        padding: 0px;
    }
    body {
        background-color: gray;
    }
    #statusLabel {
        color: dimgray;
        font-size: 20px;
        font-weight: bold;
    }
</style>
<script src="../../scripts/query-args.js" type="text/javascript"></script>
<script type="text/javascript">
    function setupHandlers() {
        var statusLabel = document.getElementById("statusLabel");
        var windowpath = "/tiles/locationchangetest/index.html";

        window.onfocus = function() {
            document.body.style.backgroundColor = "green";
            statusLabel.style.color = "darkgreen";
            window.location.href = window.location.origin + windowpath + "?usehistory";
        }
        window.onblur = function() {
            document.body.style.backgroundColor = "gray";
            statusLabel.style.color = "dimgray";
            window.location.href = window.location.origin + windowpath + "?setiframeloc";
        }
        var bottom = false;
        window.onclick = function() {
            var framepath = "/tiles/locationchangetest/iframe.html";
            if (queryArgs.usehistory != undefined) {
                frames[0].history.back();
            } else {
                if (queryArgs.setiframeloc != undefined) {
                    frames[0].location.href = frames[0].location.origin + "/crashtest.html";
                } else {
                    frames[0].location.href = frames[0].location.origin + framepath + (bottom ? "#bottom" : "#top");
                    bottom = !bottom;                    
                }
            }
        }
    }

    function init() {
        document.getElementById("statusLabel").innerHTML = window.location.href;

        extractQueryArgs();
        setupHandlers();
    }
</script>
</head>
<body onload="init()">
    <p id="statusLabel"></p>
    <iframe width="300" height="300" src="iframe.html" frameborder="0"></iframe>
</body>
</html>